[{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\__tests__\\Login.test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'BrowserRouter' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"BrowserRouter"},"fix":{"range":[162,211],"text":""},"desc":"Remove unused variable 'BrowserRouter'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'Login' is defined but never used.","line":8,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"Login"},"fix":{"range":[220,231],"text":""},"desc":"Remove unused variable 'Login'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'AuthContext' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"AuthContext"},"fix":{"range":[250,303],"text":""},"desc":"Remove unused variable 'AuthContext'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'VenueContext' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":22,"suggestions":[{"messageId":"removeVar","data":{"varName":"VenueContext"},"fix":{"range":[305,360],"text":""},"desc":"Remove unused variable 'VenueContext'."}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":14,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":14,"endColumn":5},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":16,"column":12,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":21,"column":19,"nodeType":"Identifier","messageId":"undef","endLine":21,"endColumn":23},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":39,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":39,"endColumn":9},{"ruleId":"no-undef","severity":2,"message":"'beforeEach' is not defined.","line":40,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":40,"endColumn":13},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":41,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":41,"endColumn":9},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":45,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":45,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":65,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":65,"endColumn":13},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":69,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":69,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":89,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":89,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'pinBoxes' is assigned a value but never used.","line":96,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":96,"endColumn":23,"suggestions":[{"messageId":"removeVar","data":{"varName":"pinBoxes"},"fix":{"range":[2817,2954],"text":""},"desc":"Remove unused variable 'pinBoxes'."}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":100,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":100,"endColumn":15},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":106,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":106,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":120,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":120,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":123,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":123,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":128,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":128,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":131,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":131,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":136,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":136,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":140,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":140,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":144,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":144,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":147,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":147,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":170,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":170,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":174,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":174,"endColumn":9},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":175,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":175,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":180,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":180,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":183,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":183,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":187,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":187,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'test' is not defined.","line":192,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":192,"endColumn":7},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":196,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":196,"endColumn":11}],"suppressedMessages":[],"errorCount":28,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Login Component Tests\r\n * Tests for PIN auto-submit and reset logic\r\n */\r\n\r\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\r\nimport { BrowserRouter } from 'react-router-dom';\r\nimport Login from '../pages/Login';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { VenueContext } from '../context/VenueContext';\r\nimport { authAPI } from '../lib/api';\r\n\r\n// Mock the API\r\njest.mock('../lib/api', () => ({\r\n  authAPI: {\r\n    login: jest.fn(),\r\n  },\r\n}));\r\n\r\n// Mock contexts\r\nconst mockLogin = jest.fn();\r\nconst mockVenues = [\r\n  { id: 'venue-1', name: 'Test Venue 1' },\r\n  { id: 'venue-2', name: 'Test Venue 2' },\r\n];\r\n\r\nconst renderLogin = (venuesLoading = false, venues = mockVenues) => {\r\n  return render(\r\n    <BrowserRouter>\r\n      <AuthContext.Provider value={{ login: mockLogin }}>\r\n        <VenueContext.Provider value={{ venues, loading: venuesLoading }}>\r\n          <Login />\r\n        </VenueContext.Provider>\r\n      </AuthContext.Provider>\r\n    </BrowserRouter>\r\n  );\r\n};\r\n\r\ndescribe('Login Component - PIN Auto-Submit', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    localStorage.clear();\r\n  });\r\n\r\n  test('auto-submits when 4th digit is entered', async () => {\r\n    authAPI.login.mockResolvedValue({\r\n      data: { user: { name: 'Test User' }, token: 'test-token' },\r\n    });\r\n\r\n    renderLogin();\r\n\r\n    // Select venue first\r\n    const venueSelect = screen.getByTestId('venue-select');\r\n    fireEvent.click(venueSelect);\r\n    fireEvent.click(screen.getByText('Test Venue 1'));\r\n\r\n    // Enter 4 digits\r\n    fireEvent.click(screen.getByTestId('pin-1'));\r\n    fireEvent.click(screen.getByTestId('pin-2'));\r\n    fireEvent.click(screen.getByTestId('pin-3'));\r\n    fireEvent.click(screen.getByTestId('pin-4'));\r\n\r\n    // Should auto-submit without pressing ENTER\r\n    await waitFor(() => {\r\n      expect(authAPI.login).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  test('resets PIN on failed login', async () => {\r\n    authAPI.login.mockRejectedValue({\r\n      response: { data: { detail: 'Invalid PIN' } },\r\n    });\r\n\r\n    renderLogin();\r\n\r\n    // Select venue\r\n    const venueSelect = screen.getByTestId('venue-select');\r\n    fireEvent.click(venueSelect);\r\n    fireEvent.click(screen.getByText('Test Venue 1'));\r\n\r\n    // Enter 4 digits\r\n    fireEvent.click(screen.getByTestId('pin-1'));\r\n    fireEvent.click(screen.getByTestId('pin-2'));\r\n    fireEvent.click(screen.getByTestId('pin-3'));\r\n    fireEvent.click(screen.getByTestId('pin-4'));\r\n\r\n    // Wait for auto-submit and error handling\r\n    await waitFor(() => {\r\n      expect(screen.getByText('Incorrect PIN')).toBeInTheDocument();\r\n    });\r\n\r\n    // PIN should be reset after 500ms\r\n    await waitFor(\r\n      () => {\r\n        // All PIN boxes should be empty (no filled indicators)\r\n        const pinBoxes = screen.getAllByRole('button').filter((btn) =>\r\n          btn.getAttribute('data-testid')?.startsWith('pin-')\r\n        );\r\n        // Check that PIN display is cleared\r\n        expect(screen.queryByText('Incorrect PIN')).not.toBeInTheDocument();\r\n      },\r\n      { timeout: 600 }\r\n    );\r\n  });\r\n\r\n  test('CLEAR button resets PIN immediately', () => {\r\n    renderLogin();\r\n\r\n    // Enter 3 digits\r\n    fireEvent.click(screen.getByTestId('pin-1'));\r\n    fireEvent.click(screen.getByTestId('pin-2'));\r\n    fireEvent.click(screen.getByTestId('pin-3'));\r\n\r\n    // Click CLEAR\r\n    fireEvent.click(screen.getByTestId('pin-clear'));\r\n\r\n    // PIN should be immediately cleared\r\n    // (Visual check - all PIN boxes should be empty)\r\n    const pinBoxes = document.querySelectorAll('[class*=\"rounded-full\"]');\r\n    expect(pinBoxes.length).toBe(0);\r\n  });\r\n\r\n  test('disables keypad when no venues available', () => {\r\n    renderLogin(false, []); // No venues\r\n\r\n    // All PIN buttons should be disabled\r\n    const pin1 = screen.getByTestId('pin-1');\r\n    expect(pin1).toBeDisabled();\r\n\r\n    // Should show helper text\r\n    expect(\r\n      screen.getByText(/No venues available/i)\r\n    ).toBeInTheDocument();\r\n  });\r\n\r\n  test('shows loading state for venues', () => {\r\n    renderLogin(true, []); // Loading venues\r\n\r\n    // Select should show loading placeholder\r\n    expect(screen.getByText('Loading venues...')).toBeInTheDocument();\r\n\r\n    // PIN pad should be disabled\r\n    const pin1 = screen.getByTestId('pin-1');\r\n    expect(pin1).toBeDisabled();\r\n  });\r\n\r\n  test('prevents multiple PIN entries during loading', async () => {\r\n    authAPI.login.mockImplementation(\r\n      () => new Promise((resolve) => setTimeout(resolve, 1000))\r\n    );\r\n\r\n    renderLogin();\r\n\r\n    // Select venue\r\n    const venueSelect = screen.getByTestId('venue-select');\r\n    fireEvent.click(venueSelect);\r\n    fireEvent.click(screen.getByText('Test Venue 1'));\r\n\r\n    // Enter 4 digits to trigger auto-submit\r\n    fireEvent.click(screen.getByTestId('pin-1'));\r\n    fireEvent.click(screen.getByTestId('pin-2'));\r\n    fireEvent.click(screen.getByTestId('pin-3'));\r\n    fireEvent.click(screen.getByTestId('pin-4'));\r\n\r\n    // Try to click another digit while loading\r\n    fireEvent.click(screen.getByTestId('pin-5'));\r\n\r\n    // Should not add 5th digit (PIN should stay at 4 digits)\r\n    const pin1Button = screen.getByTestId('pin-1');\r\n    expect(pin1Button).toBeDisabled();\r\n  });\r\n});\r\n\r\ndescribe('Login Component - Brand Colors', () => {\r\n  test('renders brand red accent on .AI text', () => {\r\n    renderLogin();\r\n\r\n    // Check that .AI span has brand red color\r\n    const aiText = screen.getByText('.AI');\r\n    expect(aiText).toHaveStyle({ color: 'var(--brand-accent)' });\r\n  });\r\n\r\n  test('renders ENTER button with brand red background', () => {\r\n    renderLogin();\r\n\r\n    const enterButton = screen.getByTestId('pin-submit');\r\n    expect(enterButton).toHaveStyle({\r\n      backgroundColor: 'var(--brand-accent)',\r\n    });\r\n  });\r\n\r\n  test('renders active tab with brand red background', () => {\r\n    renderLogin();\r\n\r\n    const adminTab = screen.getByTestId('login-target-admin');\r\n    expect(adminTab).toHaveStyle({\r\n      backgroundColor: 'var(--brand-accent)',\r\n    });\r\n  });\r\n});\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\crm\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\radar\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\studio\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\voice\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\features\\restin\\web\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'React' is defined but never used.","line":12,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"React"},"fix":{"range":[363,374],"text":""},"desc":"Remove unused variable 'React'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'QueryClientProvider' is defined but never used.","line":14,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"QueryClientProvider"},"fix":{"range":[446,467],"text":""},"desc":"Remove unused variable 'QueryClientProvider'."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'App' is defined but never used.","line":17,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"App"},"fix":{"range":[579,588],"text":""},"desc":"Remove unused variable 'App'."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as Sentry from \"@sentry/react\";\r\n\r\nSentry.init({\r\n  dsn: \"https://c8948ba4809a8afc56aaac4380bcae56@o4510853881921536.ingest.de.sentry.io/4510853958467664\",\r\n  environment: process.env.NODE_ENV,\r\n  enabled: process.env.NODE_ENV === \"production\",\r\n  tracesSampleRate: 0.2,\r\n  replaysSessionSampleRate: 0.1,\r\n  replaysOnErrorSampleRate: 1.0,\r\n});\r\n\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom/client\";\r\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\r\nimport './lib/i18n/config'; // Initialize i18n\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\r\n\r\nconst queryClient = new QueryClient({\r\n  defaultOptions: {\r\n    queries: {\r\n      retry: 1,\r\n      refetchOnWindowFocus: false,\r\n      staleTime: 2 * 60_000,   // 2 min — config/menu data rarely changes mid-session\r\n      gcTime: 10 * 60_000,     // 10 min — keep cache warm across navigations\r\n    },\r\n  },\r\n});\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById(\"root\"));\r\nroot.render(\r\n  <React.StrictMode>\r\n    <QueryClientProvider client={queryClient}>\r\n      <App />\r\n    </QueryClientProvider>\r\n  </React.StrictMode>,\r\n);\r\n\r\nserviceWorkerRegistration.unregister();\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\lib\\schemas\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\routes\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\arda\\.gemini\\antigravity\\scratch\\restin-ai\\frontend\\src\\serviceWorkerRegistration.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]